(()=>{"use strict";var e={9860:(e,a,s)=>{var t=s(3751),o=s(9307),l=(s(4188),s(641)),r=s(953),n=s(33);const c=s.p+"img/1.jpg";var i=s(8548),u=s(163);const d={class:"popup-container"},p={class:"feature-section"},v={class:"action-buttons"},k=["disabled"],b={class:"button-content"},f=["disabled"],g={class:"button-content"},h={key:0,class:"progress-section"},w={class:"progress-bar-wrapper"},m={class:"progress-text"},y={__name:"App",setup(e){const a=(0,r.KR)(!1),s=(0,r.KR)(!1),t=(0,r.KR)(null),o=(0,r.KR)({total:0,completed:0,progress:0});(0,l.sV)((()=>{chrome.runtime.onMessage.addListener(((e,a)=>{"articleSelected"===e.action&&(t.value=e.url,u.nk.success("文章已选择"))}))}));const y=async()=>{if(t.value)try{a.value=!0;const e=await chrome.runtime.sendMessage({action:"downloadCurrentPDF"});e.success?e.needsRedirect?u.nk.info("正在跳转到文章页面..."):u.nk.success("PDF下载已开始"):u.nk.error(e.error||"下载失败")}catch(e){u.nk.error("下载失败："+e.message)}finally{a.value=!1}else u.nk.warning("请先选择要下载的文章")},L=async()=>{try{s.value=!0;const[a]=await chrome.tabs.query({active:!0,currentWindow:!0}),t=await chrome.tabs.sendMessage(a.id,{action:"startBatchDownload"});if(t.success){o.value.total=t.total,o.value.completed=0,o.value.progress=0;for(const s of t.articles)try{await chrome.tabs.sendMessage(a.id,{action:"downloadCurrentPDF",url:s.url}),o.value.completed++,o.value.progress=o.value.completed/o.value.total*100}catch(e){console.error(`Failed to download article: ${s.title}`,e)}u.nk.success("批量下载完成")}else u.nk.error(t.error||"批量下载失败")}catch(e){u.nk.error("批量下载失败："+e.message)}finally{s.value=!1}},F=()=>{};return(e,t)=>{const u=(0,l.g2)("el-header"),_=(0,l.g2)("el-icon"),D=(0,l.g2)("el-main"),C=(0,l.g2)("el-footer"),O=(0,l.g2)("el-container");return(0,l.uX)(),(0,l.CE)("div",d,[(0,l.bF)(O,null,{default:(0,l.k6)((()=>[(0,l.bF)(u,{class:"apple-style-header"},{default:(0,l.k6)((()=>t[0]||(t[0]=[(0,l.Lk)("div",{class:"header-content"},[(0,l.Lk)("img",{src:c,alt:"Logo",class:"logo"}),(0,l.Lk)("h1",null,"CNKI PDF Downloader Pro")],-1)]))),_:1}),(0,l.bF)(D,{class:"apple-style-main"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",p,[t[4]||(t[4]=(0,l.Lk)("h2",{class:"section-title"},"PDF Download Manager",-1)),t[5]||(t[5]=(0,l.Lk)("div",{class:"pro-badge"},"Professional",-1)),(0,l.Lk)("div",v,[(0,l.Lk)("button",{class:"apple-button primary",onClick:y,disabled:a.value},[(0,l.Lk)("div",b,[(0,l.bF)(_,{class:"button-icon"},{default:(0,l.k6)((()=>[(0,l.bF)((0,r.R1)(i.f5X))])),_:1}),t[1]||(t[1]=(0,l.Lk)("span",null,"Download Current PDF",-1))])],8,k),t[3]||(t[3]=(0,l.Lk)("div",{class:"divider"},[(0,l.Lk)("span",{class:"divider-text"},"Batch Download")],-1)),(0,l.Lk)("button",{class:"apple-button secondary",onClick:L,disabled:s.value},[(0,l.Lk)("div",g,[(0,l.bF)(_,{class:"button-icon"},{default:(0,l.k6)((()=>[(0,l.bF)((0,r.R1)(i.sv7))])),_:1}),t[2]||(t[2]=(0,l.Lk)("span",null,"Download All PDFs",-1))])],8,f)]),o.value.total>0?((0,l.uX)(),(0,l.CE)("div",h,[(0,l.Lk)("div",w,[(0,l.Lk)("div",{class:"progress-bar",style:(0,n.Tr)({width:o.value.progress+"%"})},null,4)]),(0,l.Lk)("div",m," Downloaded: "+(0,n.v_)(o.value.completed)+"/"+(0,n.v_)(o.value.total),1)])):(0,l.Q3)("",!0)])])),_:1}),(0,l.bF)(C,{class:"apple-style-footer"},{default:(0,l.k6)((()=>[(0,l.Lk)("button",{class:"settings-button",onClick:F},[(0,l.bF)(_,null,{default:(0,l.k6)((()=>[(0,l.bF)((0,r.R1)(i.B5R))])),_:1}),t[6]||(t[6]=(0,l.Lk)("span",null,"Settings",-1))]),t[7]||(t[7]=(0,l.Lk)("span",{class:"version"},"v1.0.0",-1))])),_:1})])),_:1})])}}};var L=s(6262);const F=(0,L.A)(y,[["__scopeId","data-v-61f9d8a5"]]),_=F,D=(0,t.Ef)(_);D.use(o.A),D.mount("#app")}},a={};function s(t){var o=a[t];if(void 0!==o)return o.exports;var l=a[t]={exports:{}};return e[t].call(l.exports,l,l.exports,s),l.exports}s.m=e,(()=>{var e=[];s.O=(a,t,o,l)=>{if(!t){var r=1/0;for(u=0;u<e.length;u++){for(var[t,o,l]=e[u],n=!0,c=0;c<t.length;c++)(!1&l||r>=l)&&Object.keys(s.O).every((e=>s.O[e](t[c])))?t.splice(c--,1):(n=!1,l<r&&(r=l));if(n){e.splice(u--,1);var i=o();void 0!==i&&(a=i)}}return a}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[t,o,l]}})(),(()=>{s.d=(e,a)=>{for(var t in a)s.o(a,t)&&!s.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:a[t]})}})(),(()=>{s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{s.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a)})(),(()=>{s.p="/"})(),(()=>{var e={887:0};s.O.j=a=>0===e[a];var a=(a,t)=>{var o,l,[r,n,c]=t,i=0;if(r.some((a=>0!==e[a]))){for(o in n)s.o(n,o)&&(s.m[o]=n[o]);if(c)var u=c(s)}for(a&&a(t);i<r.length;i++)l=r[i],s.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return s.O(u)},t=self["webpackChunkcnki_pdf_downloader"]=self["webpackChunkcnki_pdf_downloader"]||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))})();var t=s.O(void 0,[504],(()=>s(9860)));t=s.O(t)})();